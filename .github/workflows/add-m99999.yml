name: Add m99999 module

on:
  workflow_dispatch:

jobs:
  add-module:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout current repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Configure git and create branch
        run: |
          git config user.name "komyaka-bot"
          git config user.email "komyaka@users.noreply.github.com"
          git checkout -b feature/m99999-module

      - name: Create placeholder module file
        run: |
          mkdir -p src/modules
          cat > src/modules/module_99999.c <<'MODULE'
/* Placeholder: module_99999.c
 * Полный код будет добавлен в последующем коммите/PR.
 */
MODULE

      - name: Create placeholder kernels
        run: |
          mkdir -p kernels
          cat > kernels/m99999_a0-pure.cl <<'K0'
/* Placeholder m99999_a0-pure.cl */
K0
          cat > kernels/m99999_a3-pure.cl <<'K3'
/* Placeholder m99999_a3-pure.cl */
K3

      - name: Create placeholder test
        run: |
          mkdir -p tests
          cat > tests/test_m99999_roundtrip.c <<'TST'
/* Placeholder test_m99999_roundtrip.c */
TST

      - name: Commit and push branch
        env:
          GIT_COMMITTER_NAME: github-actions
          GIT_COMMITTER_EMAIL: actions@github.com
        run: |
          git add -A
          git commit -m "Add placeholder files for m99999 module" || echo "No changes to commit"
          git push --set-upstream origin feature/m99999-module

      - name: Done
        run: echo "Branch feature/m99999-module created and pushed."
